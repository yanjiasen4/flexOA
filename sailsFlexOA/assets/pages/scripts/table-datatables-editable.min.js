var TableDatatablesEditable=function(){var e=function(){function e(e,t){for(var a=e.fnGetData(t),n=$(">td",t),l=0,r=n.length;r>l;l++)e.fnUpdate(a[l],t,l,!1);e.fnDraw()}function t(e,t){var a=e.fnGetData(t),n=$(">td",t);n[0].innerHTML='<input type="text" class="form-control input-small" value="'+a[0]+'">',n[1].innerHTML='<input type="text" class="form-control input-small" value="'+a[1]+'">',n[2].innerHTML='<input type="text" class="form-control input-small" value="'+a[2]+'">',n[3].innerHTML='<a class="edit" href="">保存</a>',n[4].innerHTML='<a class="cancel" href="">取消</a>'}function a(e,t){var a=$("input",t);e.fnUpdate(a[0].value,t,0,!1),e.fnUpdate(a[1].value,t,1,!1),e.fnUpdate(a[2].value,t,2,!1),e.fnUpdate('<a class="edit" href="">编辑</a>',t,3,!1),e.fnUpdate('<a class="delete" href="">删除</a>',t,4,!1),e.fnDraw()}var n=$("#sample_editable_1"),l=n.dataTable({lengthMenu:[[5,15,20,-1],[5,15,20,"全部"]],pageLength:5,language:{lengthMenu:" _MENU_ 记录",search:"搜索",info:"第 _START_ 到第 _END_ 条记录，总计 _TOTAL_ 条"},columnDefs:[{orderable:!0,targets:[0]},{searchable:!0,targets:[0]}],order:[[0,"asc"]]}),r=($("#sample_editable_1_wrapper"),null),i=!1;$("#sample_editable_1_new").click(function(e){if(e.preventDefault(),i&&r){if(!confirm("上一条记录尚未保存，是否保存?"))return l.fnDeleteRow(r),r=null,void(i=!1);a(l,r),$(r).find("td:first").html("Untitled"),r=null,i=!1}var n=l.fnAddData(["","","","",""]),f=l.fnGetNodes(n[0]);t(l,f),r=f,i=!0}),n.on("click",".delete",function(e){if(e.preventDefault(),0!=confirm("您确定删除这名员工吗?")){var t=$(this).parents("tr")[0];l.fnDeleteRow(t),$.ajax({url:"/manage/deleteWorker",type:"post",data:{workerID:t.id}})}}),n.on("click",".cancel",function(t){t.preventDefault(),i?(l.fnDeleteRow(r),r=null,i=!1):(e(l,r),r=null)}),n.on("click",".edit",function(n){n.preventDefault();var i=$(this).parents("tr")[0];if(null!==r&&r!=i)e(l,r),t(l,i),r=i;else if(r==i&&"保存"==this.innerHTML){a(l,r),r=null;var f=l.fnGetData(i);$.ajax({url:"/manage/updateWorker",type:"post",data:{workerID:i.id,title:f[2]}})}else t(l,i),r=i})};return{init:function(){e()}}}();jQuery(document).ready(function(){TableDatatablesEditable.init()});